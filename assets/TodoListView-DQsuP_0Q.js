import{h as V,r as n,i as B,j as D,c as d,a as t,t as y,k as c,w as b,v as M,l as U,n as m,F as N,m as P,u as E,f as u,o as h,p as F}from"./index-nnR4eyqz.js";const K={id:"todoListPage",class:"bg-half"},S=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),j={class:"todo_sm"},R={href:"#"},W={class:"conatiner todoListPage vhContainer"},q={class:"todoList_Content"},G={class:"inputBox"},H=t("i",{class:"fa fa-plus"},null,-1),J=[H],Q={key:0},X={key:1,class:"todoList_list"},Y={class:"todoList_tab"},Z={class:"todoList_items"},tt={class:"todoList_label"},et=["onUpdate:modelValue","onClick"],st=["onClick"],ot=t("i",{class:"fa fa-times","aria-hidden":"true"},null,-1),at=[ot],lt={class:"todoList_statistics"},r="https://todolist-api.hexschool.io",ct={__name:"TodoListView",setup(nt){var w;const p=V(),a=n(""),C=n(""),z=async()=>{try{const e=await u.get(`${r}/users/checkout`,{headers:{Authorization:a.value}});C.value=e.data.nickname}catch{alert("驗證失敗，請回登入頁面"),p.push("/")}},v=n([]),i=n([]),f=async()=>{try{const e=await u.get(`${r}/todos`,{headers:{Authorization:a.value}});console.log(e.data.data),i.value=e.data.data,L()}catch{alert("資料取得失敗!!")}},_=n(""),$=async()=>{try{const e=await u.post(`${r}/todos`,{content:`${_.value}`},{headers:{Authorization:a.value}});_.value="",f(),alert("新增代辦成功!!")}catch{alert("新增失敗!!")}},A=async e=>{try{const s=await u.patch(`${r}/todos/${e}/toggle`,{id:e},{headers:{Authorization:a.value}});L()}catch{alert("切換狀態失敗!!")}},I=async e=>{try{const s=await u.delete(`${r}/todos/${e}`,{headers:{Authorization:a.value}});f()}catch{alert("刪除失敗!!")}},l=n(0),k=e=>{l.value=e,L()},L=()=>{l.value==0?v.value=i.value:l.value==1?v.value=i.value.filter(e=>e.status==!1):l.value==2&&(v.value=i.value.filter(e=>e.status==!0))};let x=n(0);x=B(()=>i.value.filter(e=>e.status==!1).length);const O=async()=>{try{const e=await u.post(`${r}/users/sign_out`,{},{headers:{Authorization:a.value}});p.push("/")}catch{alert("登出錯誤!!")}},T=(w=document.cookie.split("; ").find(e=>e.startsWith("hexschoolTodo=")))==null?void 0:w.split("=")[1];return D(()=>{T?(a.value=T,z(),f()):(alert("驗證失敗，請回登入頁面"),p.push("/"))}),(e,s)=>(h(),d("div",K,[t("nav",null,[S,t("ul",null,[t("li",j,[t("a",R,[t("span",null,y(C.value),1)])]),t("li",null,[t("a",{href:"#loginPage",onClick:c(O,["prevent"])},"登出")])])]),t("div",W,[t("div",q,[t("div",G,[b(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>_.value=o),placeholder:"請輸入待辦事項",onKeyup:U($,["enter"])},null,544),[[M,_.value]]),t("a",{href:"#",onClick:c($,["prevent"])},J)]),i.value.length==0?(h(),d("div",Q,"目前尚無待辦事項")):(h(),d("div",X,[t("ul",Y,[t("li",null,[t("a",{href:"#",class:m(l.value==0?"active":""),onClick:s[1]||(s[1]=c(o=>k(0),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:m(l.value==1?"active":""),onClick:s[2]||(s[2]=c(o=>k(1),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:m(l.value==2?"active":""),onClick:s[3]||(s[3]=c(o=>k(2),["prevent"]))},"已完成",2)])]),t("div",Z,[(h(!0),d(N,null,P(v.value,o=>(h(),d("ul",{class:"todoList_item",key:o.id},[t("li",null,[t("label",tt,[b(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":g=>o.status=g,onClick:g=>A(o.id)},null,8,et),[[F,o.status]]),t("span",null,y(o.content),1)]),t("a",{href:"#",onClick:c(g=>I(o.id),["prevent"])},at,8,st)])]))),128)),t("div",lt,[t("p",null,y(E(x))+" 個待完成項目",1)])])]))])])]))}};export{ct as default};
