import{h as V,r as n,i as B,j as D,c as d,a as t,k as i,t as y,w as b,v as M,l as U,n as m,F as N,m as P,u as E,f as r,o as h,p as F}from"./index-BMSXFWdJ.js";const K={id:"todoListPage",class:"bg-half"},S=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),j={class:"todo_sm"},R={class:"conatiner todoListPage vhContainer"},W={class:"todoList_Content"},q={class:"inputBox"},G=t("i",{class:"fa fa-plus"},null,-1),H=[G],J={key:0},Q={key:1,class:"todoList_list"},X={class:"todoList_tab"},Y={class:"todoList_items"},Z={class:"todoList_label"},tt=["onUpdate:modelValue","onClick"],et=["onClick"],st=t("i",{class:"fa fa-times","aria-hidden":"true"},null,-1),ot=[st],at={class:"todoList_statistics"},u="https://todolist-api.hexschool.io",it={__name:"TodoListView",setup(lt){var w;const _=V(),a=n(""),C=n(""),z=async()=>{try{const e=await r.get(`${u}/users/checkout`,{headers:{Authorization:a.value}});C.value=e.data.nickname}catch{alert("驗證失敗，請回登入頁面"),_.push("/")}},v=n([]),c=n([]),f=async()=>{try{const e=await r.get(`${u}/todos`,{headers:{Authorization:a.value}});console.log(e.data.data),c.value=e.data.data,L()}catch{alert("資料取得失敗!!")}},p=n(""),$=async()=>{try{const e=await r.post(`${u}/todos`,{content:`${p.value}`},{headers:{Authorization:a.value}});p.value="",f(),alert("新增代辦成功!!")}catch{alert("新增失敗!!")}},A=async e=>{try{const s=await r.patch(`${u}/todos/${e}/toggle`,{id:e},{headers:{Authorization:a.value}});L()}catch{alert("切換狀態失敗!!")}},I=async e=>{try{const s=await r.delete(`${u}/todos/${e}`,{headers:{Authorization:a.value}});f()}catch{alert("刪除失敗!!")}},l=n(0),k=e=>{l.value=e,L()},L=()=>{l.value==0?v.value=c.value:l.value==1?v.value=c.value.filter(e=>e.status==!1):l.value==2&&(v.value=c.value.filter(e=>e.status==!0))};let x=n(0);x=B(()=>c.value.filter(e=>e.status==!1).length);const O=async()=>{try{const e=await r.post(`${u}/users/sign_out`,{},{headers:{Authorization:a.value}});_.push("/")}catch{alert("登出錯誤!!")}},T=(w=document.cookie.split("; ").find(e=>e.startsWith("hexschoolTodo=")))==null?void 0:w.split("=")[1];return D(()=>{T?(a.value=T,z(),f()):(alert("驗證失敗，請回登入頁面"),_.push("/"))}),(e,s)=>(h(),d("div",K,[t("nav",null,[S,t("ul",null,[t("li",j,[t("a",{href:"#",onClick:s[0]||(s[0]=i(()=>{},["prevent"]))},[t("span",null,y(C.value),1)])]),t("li",null,[t("a",{href:"#loginPage",onClick:i(O,["prevent"])},"登出")])])]),t("div",R,[t("div",W,[t("div",q,[b(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>p.value=o),placeholder:"請輸入待辦事項",onKeyup:U($,["enter"])},null,544),[[M,p.value]]),t("a",{href:"#",onClick:i($,["prevent"])},H)]),c.value.length==0?(h(),d("div",J,"目前尚無待辦事項")):(h(),d("div",Q,[t("ul",X,[t("li",null,[t("a",{href:"#",class:m(l.value==0?"active":""),onClick:s[2]||(s[2]=i(o=>k(0),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:m(l.value==1?"active":""),onClick:s[3]||(s[3]=i(o=>k(1),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:m(l.value==2?"active":""),onClick:s[4]||(s[4]=i(o=>k(2),["prevent"]))},"已完成",2)])]),t("div",Y,[(h(!0),d(N,null,P(v.value,o=>(h(),d("ul",{class:"todoList_item",key:o.id},[t("li",null,[t("label",Z,[b(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":g=>o.status=g,onClick:g=>A(o.id)},null,8,tt),[[F,o.status]]),t("span",null,y(o.content),1)]),t("a",{href:"#",onClick:i(g=>I(o.id),["prevent"])},ot,8,et)])]))),128)),t("div",at,[t("p",null,y(E(x))+" 個待完成項目",1)])])]))])])]))}};export{it as default};
